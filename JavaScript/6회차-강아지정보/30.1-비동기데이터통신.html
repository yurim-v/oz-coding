<!--2024.05.28-->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>비동기 데이터 통신</title>

    <style>

    </style>
  </head>
  <body>

    <button id="push"> PUSH</button>
    <hr>
    <img src="", alt="강아지 사진">

    <script>


      // 1. 요청 객체 생성
      const request = new XMLHttpRequest();

      const bt = document.querySelector('button');
      const img = document.querySelector('img');

      // 2. 요청에 대한 핸들러 함수 정의
      bt.addEventListener('click',function(){
        request.open( "get" , "https://dog.ceo/api/breeds/image/random");

      
        request.addEventListener('load', function(){
          let img_src = JSON.parse(request.response);
          img.src = img_src.message;
        })

        // 3. 요청 전송
        request.send(); 
        /*
         비동기 데이터 처리 방식인 XMLHttpRequest 객체는 언제 서버로부터 데이터 응답이 올지 모른다.

         send() 메소드를 이벤트 핸들러 전에 작성할 경우,
         서버로부터 응답이 핸들러 함수의 코드가 실행되기 전에 빨리 도착한다면,
         응답에 대한 핸들러 함수가 제대로 작동하지 앟을 수 있다.
         
         따라서, 핸들러 함수는 send() 메소드 이전에 작성하자 !
         */        
        
      })
      



    </script>
  </body>
</html>